{"ast":null,"code":"var _jsxFileName = \"/home/tohzen/coding/Anime/Anime-frontend/src/components/Login/Login.js\";\nimport React, { Component } from \"react\";\nimport { isEmpty, isEmail } from \"validator\";\nimport jwtDecode from \"jwt-decode\";\nimport { toast } from \"react-toastify\";\nimport Axios from \"../utils/Axios\";\nimport checkIfUserIsAuth from \"../utils/checkIfUserIsAuth\";\nimport setAxiosAuthToken from \"../utils/setAxiosAuthToken\";\nimport \"./Login.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class Login extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      email: \"\",\n      emailError: \"\",\n      emailOnFocus: false,\n      password: \"\",\n      passwordError: \"\",\n      passwordOnFocus: false,\n      canSubmit: true\n    };\n\n    this.handleOnChange = event => {\n      this.setState({\n        [event.target.name]: event.target.value\n      }, () => {\n        if (event.target.name === \"email\") {\n          if (isEmpty(this.state.email)) {\n            this.setState({\n              emailError: \"Email cannot be empty\",\n              canSubmit: true\n            });\n          } else {\n            this.setState({\n              emailError: \"\"\n            });\n          }\n        }\n\n        if (event.target.name === \"password\") {\n          if (isEmpty(this.state.password)) {\n            this.setState({\n              passwordError: \"Password cannot be empty\",\n              canSubmit: true\n            });\n          } else {\n            this.setState({\n              passwordError: \"\"\n            });\n          }\n        }\n      });\n    };\n\n    this.handleInputOnFocus = event => {\n      if (!this.state[`${event.target.name}OnFocus`]) {\n        this.setState({\n          [`${event.target.name}OnFocus`]: true\n        });\n      }\n    };\n\n    this.handleOnSubmit = async event => {\n      event.preventDefault();\n\n      try {\n        let result = await Axios.post(\"/api/user/login\", {\n          email: this.state.email,\n          password: this.state.password\n        });\n        let jwtToken = result.data.payload;\n        console.log(jwtToken); //call setAxiosAuthToken here\n\n        setAxiosAuthToken(jwtToken);\n        let decodedToken = jwtDecode(jwtToken);\n        console.log(decodedToken);\n        this.props.handleUserLogin(decodedToken);\n        window.localStorage.setItem(\"jwtToken\", jwtToken);\n        toast.success(\"Login success!\");\n        this.props.history.push(\"/anime\");\n      } catch (e) {\n        if (e.response.status === 429) {\n          toast.error(e.response.data);\n        } else {\n          toast.error(e.response.data.payload);\n        }\n      }\n    };\n  }\n\n  componentDidMount() {\n    let isAuth = checkIfUserIsAuth();\n\n    if (isAuth) {\n      this.props.history.push(\"/anime\");\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    console.log(this.componentDidu);\n\n    if (prevState.canSubmit === true) {\n      if (this.state.emailOnFocus && this.state.passwordOnFocus) {\n        if (this.state.emailError.length === 0 && this.state.passwordError.length === 0) {\n          this.setState({\n            canSubmit: false\n          });\n        } else {\n          this.setState({\n            canSubmit: true\n          });\n        }\n      }\n    }\n  }\n\n  render() {\n    const {\n      email,\n      emailError,\n      password,\n      passwordError,\n      canSubmit\n    } = this.state; //console.log(this.props);\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-text\",\n        children: \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-div\",\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"form\",\n          onSubmit: this.handleOnSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group-block\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"block-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"email\",\n                children: \"Email\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"email\",\n                id: \"email\",\n                placeholder: \"Email\",\n                name: \"email\",\n                value: email,\n                onChange: this.handleOnChange,\n                onFocus: this.handleInputOnFocus,\n                autoFocus: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"errorMessage\",\n                children: emailError && emailError\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group-block\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"block-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: \"password\",\n                children: \"Password\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 157,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                id: \"password\",\n                placeholder: \"Password\",\n                name: \"password\",\n                value: password,\n                onFocus: this.handleInputOnFocus,\n                onChange: this.handleOnChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"errorMessage\",\n                children: passwordError && passwordError\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"button-container\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              disabled: canSubmit,\n              children: \"Submit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this);\n  }\n\n}\nexport default Login;","map":{"version":3,"sources":["/home/tohzen/coding/Anime/Anime-frontend/src/components/Login/Login.js"],"names":["React","Component","isEmpty","isEmail","jwtDecode","toast","Axios","checkIfUserIsAuth","setAxiosAuthToken","Login","state","email","emailError","emailOnFocus","password","passwordError","passwordOnFocus","canSubmit","handleOnChange","event","setState","target","name","value","handleInputOnFocus","handleOnSubmit","preventDefault","result","post","jwtToken","data","payload","console","log","decodedToken","props","handleUserLogin","window","localStorage","setItem","success","history","push","e","response","status","error","componentDidMount","isAuth","componentDidUpdate","prevProps","prevState","componentDidu","length","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { isEmpty, isEmail } from \"validator\";\nimport jwtDecode from \"jwt-decode\";\nimport { toast } from \"react-toastify\";\nimport Axios from \"../utils/Axios\";\nimport checkIfUserIsAuth from \"../utils/checkIfUserIsAuth\";\nimport setAxiosAuthToken from \"../utils/setAxiosAuthToken\";\nimport \"./Login.css\";\n\n\nexport class Login extends Component {\n  state = {\n    email: \"\",\n    emailError: \"\",\n    emailOnFocus: false,\n    password: \"\",\n    passwordError: \"\",\n    passwordOnFocus: false,\n    canSubmit: true,\n  };\n\n  componentDidMount() {\n    let isAuth = checkIfUserIsAuth();\n\n    if (isAuth) {\n      this.props.history.push(\"/anime\");\n    }\n  }\n\n  handleOnChange = (event) => {\n    this.setState(\n      {\n        [event.target.name]: event.target.value,\n      },\n      () => {\n        if (event.target.name === \"email\") {\n          if (isEmpty(this.state.email)) {\n            this.setState({\n              emailError: \"Email cannot be empty\",\n              canSubmit: true,\n            });\n          } else {\n            this.setState({\n              emailError: \"\",\n            });\n          }\n        }\n\n        if (event.target.name === \"password\") {\n          if (isEmpty(this.state.password)) {\n            this.setState({\n              passwordError: \"Password cannot be empty\",\n              canSubmit: true,\n            });\n          } else {\n            this.setState({\n              passwordError: \"\",\n            });\n          }\n        }\n      }\n    );\n  };\n\n  componentDidUpdate(prevProps, prevState) {\n    console.log(this.componentDidu)\n    if (prevState.canSubmit === true) {\n      if (this.state.emailOnFocus && this.state.passwordOnFocus) {\n        if (\n          this.state.emailError.length === 0 &&\n          this.state.passwordError.length === 0\n        ) {\n          this.setState({\n            canSubmit: false,\n          });\n        } else {\n          this.setState({\n            canSubmit: true,\n          });\n        }\n      }\n    }\n  }\n\n  handleInputOnFocus = (event) => {\n    if (!this.state[`${event.target.name}OnFocus`]) {\n      this.setState({\n        [`${event.target.name}OnFocus`]: true,\n      });\n    }\n  };\n\n  handleOnSubmit = async (event) => {\n    event.preventDefault();\n\n    try {\n      let result = await Axios.post(\"/api/user/login\", {\n        email: this.state.email,\n        password: this.state.password,\n      });\n\n      let jwtToken = result.data.payload;\n\n      console.log(jwtToken);\n      //call setAxiosAuthToken here\n      setAxiosAuthToken(jwtToken);\n\n      let decodedToken = jwtDecode(jwtToken);\n      console.log(decodedToken);\n\n      this.props.handleUserLogin(decodedToken);\n\n      window.localStorage.setItem(\"jwtToken\", jwtToken);\n      toast.success(\"Login success!\");\n\n      this.props.history.push(\"/anime\");\n    } catch (e) {\n      if (e.response.status === 429) {\n        toast.error(e.response.data);\n      } else {\n        toast.error(e.response.data.payload);\n      }\n    }\n  };\n\n  render() {\n    const { email, emailError, password, passwordError, canSubmit } =\n      this.state;\n\n    //console.log(this.props);\n\n    return (\n      <div className=\"container\">\n        <div className=\"form-text\">Login</div>\n\n        <div className=\"form-div\">\n          <form className=\"form\" onSubmit={this.handleOnSubmit}>\n            <div className=\"form-group-block\">\n              <div className=\"block-container\">\n                <label htmlFor=\"email\">Email</label>\n                <input\n                  type=\"email\"\n                  id=\"email\"\n                  placeholder=\"Email\"\n                  name=\"email\"\n                  value={email}\n                  onChange={this.handleOnChange}\n                  onFocus={this.handleInputOnFocus}\n                  autoFocus\n                />\n                <div className=\"errorMessage\">{emailError && emailError}</div>\n              </div>\n            </div>\n\n            <div className=\"form-group-block\">\n              <div className=\"block-container\">\n                <label htmlFor=\"password\">Password</label>\n                <input\n                  type=\"text\"\n                  id=\"password\"\n                  placeholder=\"Password\"\n                  name=\"password\"\n                  value={password}\n                  onFocus={this.handleInputOnFocus}\n                  onChange={this.handleOnChange}\n                />\n                <div className=\"errorMessage\">\n                  {passwordError && passwordError}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"button-container\">\n              <button type=\"submit\" disabled={canSubmit}>\n                Submit\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}